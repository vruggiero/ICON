!  @authors 01/2024 :: ICON Community Interface  <comin@icon-model.org>
!
!  SPDX-License-Identifier: BSD-3-Clause
!
!  Please see the file LICENSE in the root of the source tree for this code.
!  Where software is supplied by third parties, it is indicated in the
!  headers of the routines.

! *** DO NOT EDIT MANUALLY!  Generated by python script in utils/. DO NOT EDIT MANUALLY! *** !

MODULE comin_descrdata_load

  USE netcdf,                 ONLY: nf90_inquire_attribute, nf90_get_att,      &
    &                               nf90_inq_varid, nf90_get_var, NF90_GLOBAL, &
    &                               NF90_NOERR
  USE netcdf_utils,           ONLY: nf90, nf90_utils_def_var, nf90_utils_get_shape
  USE comin_plugin_interface, ONLY: t_comin_descrdata_global, t_comin_descrdata_domain

  IMPLICIT NONE

  PUBLIC

CONTAINS

  SUBROUTINE comin_descrdata_load_global(ncid, descrdata_obj)
    INTEGER, INTENT(IN)                           :: ncid
    TYPE(t_comin_descrdata_global), INTENT(INOUT) :: descrdata_obj
    INTEGER :: var_id, status
    INTEGER :: tmp  ! <- workaround for LOGICAL
    INTEGER :: shap(5)

    CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "n_dom", descrdata_obj%n_dom))
    CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "max_dom", descrdata_obj%max_dom))
    CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "nproma", descrdata_obj%nproma))
    CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "wp", descrdata_obj%wp))
    CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "min_rlcell_int", descrdata_obj%min_rlcell_int))
    CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "min_rlcell", descrdata_obj%min_rlcell))
    CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "max_rlcell", descrdata_obj%max_rlcell))
    CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "min_rlvert_int", descrdata_obj%min_rlvert_int))
    CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "min_rlvert", descrdata_obj%min_rlvert))
    CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "max_rlvert", descrdata_obj%max_rlvert))
    CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "min_rledge_int", descrdata_obj%min_rledge_int))
    CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "min_rledge", descrdata_obj%min_rledge))
    CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "max_rledge", descrdata_obj%max_rledge))
    CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "grf_bdywidth_c", descrdata_obj%grf_bdywidth_c))
    CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "grf_bdywidth_e", descrdata_obj%grf_bdywidth_e))
    CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "lrestartrun", tmp))
    descrdata_obj%lrestartrun = tmp /= 0
    status = nf90_inq_varid(ncid, "vct_a", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:1) = nf90_utils_get_shape(ncid, "vct_a", 1)
      ALLOCATE(descrdata_obj%vct_a(shap(1)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%vct_a))
    ENDIF
    CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "yac_instance_id", descrdata_obj%yac_instance_id))
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "host_git_remote_url", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(CHARACTER(LEN=shap(1)) :: descrdata_obj%host_git_remote_url)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "host_git_remote_url", descrdata_obj%host_git_remote_url))
    ENDIF
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "host_git_branch", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(CHARACTER(LEN=shap(1)) :: descrdata_obj%host_git_branch)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "host_git_branch", descrdata_obj%host_git_branch))
    ENDIF
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "host_git_tag", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(CHARACTER(LEN=shap(1)) :: descrdata_obj%host_git_tag)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "host_git_tag", descrdata_obj%host_git_tag))
    ENDIF
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "host_revision", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(CHARACTER(LEN=shap(1)) :: descrdata_obj%host_revision)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "host_revision", descrdata_obj%host_revision))
    ENDIF
    CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "has_device", tmp))
    descrdata_obj%has_device = tmp /= 0
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "device_name", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(CHARACTER(LEN=shap(1)) :: descrdata_obj%device_name)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "device_name", descrdata_obj%device_name))
    ENDIF
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "device_vendor", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(CHARACTER(LEN=shap(1)) :: descrdata_obj%device_vendor)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "device_vendor", descrdata_obj%device_vendor))
    ENDIF
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "device_driver", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(CHARACTER(LEN=shap(1)) :: descrdata_obj%device_driver)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "device_driver", descrdata_obj%device_driver))
    ENDIF

  END SUBROUTINE comin_descrdata_load_global

  SUBROUTINE comin_descrdata_load_domain(ncid, descrdata_obj)
    INTEGER, INTENT(IN)                           :: ncid
    TYPE(t_comin_descrdata_domain), INTENT(INOUT) :: descrdata_obj
    INTEGER :: var_id, status
    INTEGER :: shap(5)

    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "grid_filename", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(CHARACTER(LEN=shap(1)) :: descrdata_obj%grid_filename)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "grid_filename", descrdata_obj%grid_filename))
    ENDIF
    status = nf90_inq_varid(ncid, "grid_uuid", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:1) = nf90_utils_get_shape(ncid, "grid_uuid", 1)
      ALLOCATE(descrdata_obj%grid_uuid(shap(1)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%grid_uuid))
    ENDIF
    status = nf90_inq_varid(ncid, "number_of_grid_used", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:1) = nf90_utils_get_shape(ncid, "number_of_grid_used", 1)
      ALLOCATE(descrdata_obj%number_of_grid_used(shap(1)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%number_of_grid_used))
    ENDIF
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "id", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(descrdata_obj%id)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "id", descrdata_obj%id))
    ENDIF
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "n_childdom", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(descrdata_obj%n_childdom)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "n_childdom", descrdata_obj%n_childdom))
    ENDIF
    CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "dom_start", descrdata_obj%dom_start))
    CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "dom_end", descrdata_obj%dom_end))
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "nlev", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(descrdata_obj%nlev)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "nlev", descrdata_obj%nlev))
    ENDIF
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "nshift", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(descrdata_obj%nshift)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "nshift", descrdata_obj%nshift))
    ENDIF
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "nshift_total", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(descrdata_obj%nshift_total)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "nshift_total", descrdata_obj%nshift_total))
    ENDIF
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "cells%ncells", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(descrdata_obj%cells%ncells)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "cells%ncells", descrdata_obj%cells%ncells))
    ENDIF
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "cells%ncells_global", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(descrdata_obj%cells%ncells_global)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "cells%ncells_global", descrdata_obj%cells%ncells_global))
    ENDIF
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "cells%nblks", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(descrdata_obj%cells%nblks)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "cells%nblks", descrdata_obj%cells%nblks))
    ENDIF
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "cells%max_connectivity", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(descrdata_obj%cells%max_connectivity)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "cells%max_connectivity", descrdata_obj%cells%max_connectivity))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%num_edges", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:2) = nf90_utils_get_shape(ncid, "cells%num_edges", 2)
      ALLOCATE(descrdata_obj%cells%num_edges(shap(1),shap(2)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%num_edges))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%refin_ctrl", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:2) = nf90_utils_get_shape(ncid, "cells%refin_ctrl", 2)
      ALLOCATE(descrdata_obj%cells%refin_ctrl(shap(1),shap(2)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%refin_ctrl))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%start_index", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:1) = nf90_utils_get_shape(ncid, "cells%start_index", 1)
      ALLOCATE(descrdata_obj%cells%start_index(shap(1)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%start_index))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%end_index", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:1) = nf90_utils_get_shape(ncid, "cells%end_index", 1)
      ALLOCATE(descrdata_obj%cells%end_index(shap(1)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%end_index))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%start_block", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:1) = nf90_utils_get_shape(ncid, "cells%start_block", 1)
      ALLOCATE(descrdata_obj%cells%start_block(shap(1)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%start_block))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%end_block", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:1) = nf90_utils_get_shape(ncid, "cells%end_block", 1)
      ALLOCATE(descrdata_obj%cells%end_block(shap(1)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%end_block))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%child_id", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:2) = nf90_utils_get_shape(ncid, "cells%child_id", 2)
      ALLOCATE(descrdata_obj%cells%child_id(shap(1),shap(2)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%child_id))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%child_idx", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "cells%child_idx", 3)
      ALLOCATE(descrdata_obj%cells%child_idx(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%child_idx))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%child_blk", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "cells%child_blk", 3)
      ALLOCATE(descrdata_obj%cells%child_blk(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%child_blk))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%parent_glb_idx", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:2) = nf90_utils_get_shape(ncid, "cells%parent_glb_idx", 2)
      ALLOCATE(descrdata_obj%cells%parent_glb_idx(shap(1),shap(2)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%parent_glb_idx))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%parent_glb_blk", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:2) = nf90_utils_get_shape(ncid, "cells%parent_glb_blk", 2)
      ALLOCATE(descrdata_obj%cells%parent_glb_blk(shap(1),shap(2)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%parent_glb_blk))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%vertex_idx", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "cells%vertex_idx", 3)
      ALLOCATE(descrdata_obj%cells%vertex_idx(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%vertex_idx))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%vertex_blk", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "cells%vertex_blk", 3)
      ALLOCATE(descrdata_obj%cells%vertex_blk(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%vertex_blk))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%neighbor_blk", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "cells%neighbor_blk", 3)
      ALLOCATE(descrdata_obj%cells%neighbor_blk(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%neighbor_blk))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%neighbor_idx", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "cells%neighbor_idx", 3)
      ALLOCATE(descrdata_obj%cells%neighbor_idx(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%neighbor_idx))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%edge_idx", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "cells%edge_idx", 3)
      ALLOCATE(descrdata_obj%cells%edge_idx(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%edge_idx))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%edge_blk", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "cells%edge_blk", 3)
      ALLOCATE(descrdata_obj%cells%edge_blk(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%edge_blk))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%clon", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:2) = nf90_utils_get_shape(ncid, "cells%clon", 2)
      ALLOCATE(descrdata_obj%cells%clon(shap(1),shap(2)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%clon))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%clat", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:2) = nf90_utils_get_shape(ncid, "cells%clat", 2)
      ALLOCATE(descrdata_obj%cells%clat(shap(1),shap(2)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%clat))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%area", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:2) = nf90_utils_get_shape(ncid, "cells%area", 2)
      ALLOCATE(descrdata_obj%cells%area(shap(1),shap(2)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%area))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%hhl", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "cells%hhl", 3)
      ALLOCATE(descrdata_obj%cells%hhl(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%hhl))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%glb_index", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:1) = nf90_utils_get_shape(ncid, "cells%glb_index", 1)
      ALLOCATE(descrdata_obj%cells%glb_index(shap(1)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%glb_index))
    ENDIF
    status = nf90_inq_varid(ncid, "cells%decomp_domain", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:2) = nf90_utils_get_shape(ncid, "cells%decomp_domain", 2)
      ALLOCATE(descrdata_obj%cells%decomp_domain(shap(1),shap(2)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%cells%decomp_domain))
    ENDIF
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "verts%nverts", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(descrdata_obj%verts%nverts)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "verts%nverts", descrdata_obj%verts%nverts))
    ENDIF
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "verts%nverts_global", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(descrdata_obj%verts%nverts_global)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "verts%nverts_global", descrdata_obj%verts%nverts_global))
    ENDIF
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "verts%nblks", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(descrdata_obj%verts%nblks)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "verts%nblks", descrdata_obj%verts%nblks))
    ENDIF
    status = nf90_inq_varid(ncid, "verts%num_edges", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:2) = nf90_utils_get_shape(ncid, "verts%num_edges", 2)
      ALLOCATE(descrdata_obj%verts%num_edges(shap(1),shap(2)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%verts%num_edges))
    ENDIF
    status = nf90_inq_varid(ncid, "verts%refin_ctrl", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:2) = nf90_utils_get_shape(ncid, "verts%refin_ctrl", 2)
      ALLOCATE(descrdata_obj%verts%refin_ctrl(shap(1),shap(2)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%verts%refin_ctrl))
    ENDIF
    status = nf90_inq_varid(ncid, "verts%start_index", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:1) = nf90_utils_get_shape(ncid, "verts%start_index", 1)
      ALLOCATE(descrdata_obj%verts%start_index(shap(1)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%verts%start_index))
    ENDIF
    status = nf90_inq_varid(ncid, "verts%end_index", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:1) = nf90_utils_get_shape(ncid, "verts%end_index", 1)
      ALLOCATE(descrdata_obj%verts%end_index(shap(1)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%verts%end_index))
    ENDIF
    status = nf90_inq_varid(ncid, "verts%start_block", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:1) = nf90_utils_get_shape(ncid, "verts%start_block", 1)
      ALLOCATE(descrdata_obj%verts%start_block(shap(1)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%verts%start_block))
    ENDIF
    status = nf90_inq_varid(ncid, "verts%end_block", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:1) = nf90_utils_get_shape(ncid, "verts%end_block", 1)
      ALLOCATE(descrdata_obj%verts%end_block(shap(1)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%verts%end_block))
    ENDIF
    status = nf90_inq_varid(ncid, "verts%neighbor_blk", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "verts%neighbor_blk", 3)
      ALLOCATE(descrdata_obj%verts%neighbor_blk(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%verts%neighbor_blk))
    ENDIF
    status = nf90_inq_varid(ncid, "verts%neighbor_idx", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "verts%neighbor_idx", 3)
      ALLOCATE(descrdata_obj%verts%neighbor_idx(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%verts%neighbor_idx))
    ENDIF
    status = nf90_inq_varid(ncid, "verts%cell_idx", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "verts%cell_idx", 3)
      ALLOCATE(descrdata_obj%verts%cell_idx(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%verts%cell_idx))
    ENDIF
    status = nf90_inq_varid(ncid, "verts%cell_blk", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "verts%cell_blk", 3)
      ALLOCATE(descrdata_obj%verts%cell_blk(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%verts%cell_blk))
    ENDIF
    status = nf90_inq_varid(ncid, "verts%edge_idx", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "verts%edge_idx", 3)
      ALLOCATE(descrdata_obj%verts%edge_idx(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%verts%edge_idx))
    ENDIF
    status = nf90_inq_varid(ncid, "verts%edge_blk", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "verts%edge_blk", 3)
      ALLOCATE(descrdata_obj%verts%edge_blk(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%verts%edge_blk))
    ENDIF
    status = nf90_inq_varid(ncid, "verts%vlon", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:2) = nf90_utils_get_shape(ncid, "verts%vlon", 2)
      ALLOCATE(descrdata_obj%verts%vlon(shap(1),shap(2)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%verts%vlon))
    ENDIF
    status = nf90_inq_varid(ncid, "verts%vlat", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:2) = nf90_utils_get_shape(ncid, "verts%vlat", 2)
      ALLOCATE(descrdata_obj%verts%vlat(shap(1),shap(2)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%verts%vlat))
    ENDIF
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "edges%nedges", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(descrdata_obj%edges%nedges)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "edges%nedges", descrdata_obj%edges%nedges))
    ENDIF
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "edges%nedges_global", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(descrdata_obj%edges%nedges_global)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "edges%nedges_global", descrdata_obj%edges%nedges_global))
    ENDIF
    status = nf90_inquire_attribute(ncid, NF90_GLOBAL, "edges%nblks", len=shap(1))
    IF(status == NF90_NOERR) THEN
      ALLOCATE(descrdata_obj%edges%nblks)
      CALL nf90(nf90_get_att(ncid, NF90_GLOBAL, "edges%nblks", descrdata_obj%edges%nblks))
    ENDIF
    status = nf90_inq_varid(ncid, "edges%refin_ctrl", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:2) = nf90_utils_get_shape(ncid, "edges%refin_ctrl", 2)
      ALLOCATE(descrdata_obj%edges%refin_ctrl(shap(1),shap(2)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%edges%refin_ctrl))
    ENDIF
    status = nf90_inq_varid(ncid, "edges%start_index", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:1) = nf90_utils_get_shape(ncid, "edges%start_index", 1)
      ALLOCATE(descrdata_obj%edges%start_index(shap(1)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%edges%start_index))
    ENDIF
    status = nf90_inq_varid(ncid, "edges%end_index", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:1) = nf90_utils_get_shape(ncid, "edges%end_index", 1)
      ALLOCATE(descrdata_obj%edges%end_index(shap(1)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%edges%end_index))
    ENDIF
    status = nf90_inq_varid(ncid, "edges%start_block", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:1) = nf90_utils_get_shape(ncid, "edges%start_block", 1)
      ALLOCATE(descrdata_obj%edges%start_block(shap(1)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%edges%start_block))
    ENDIF
    status = nf90_inq_varid(ncid, "edges%end_block", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:1) = nf90_utils_get_shape(ncid, "edges%end_block", 1)
      ALLOCATE(descrdata_obj%edges%end_block(shap(1)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%edges%end_block))
    ENDIF
    status = nf90_inq_varid(ncid, "edges%child_id", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:2) = nf90_utils_get_shape(ncid, "edges%child_id", 2)
      ALLOCATE(descrdata_obj%edges%child_id(shap(1),shap(2)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%edges%child_id))
    ENDIF
    status = nf90_inq_varid(ncid, "edges%child_idx", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "edges%child_idx", 3)
      ALLOCATE(descrdata_obj%edges%child_idx(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%edges%child_idx))
    ENDIF
    status = nf90_inq_varid(ncid, "edges%child_blk", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "edges%child_blk", 3)
      ALLOCATE(descrdata_obj%edges%child_blk(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%edges%child_blk))
    ENDIF
    status = nf90_inq_varid(ncid, "edges%parent_glb_idx", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:2) = nf90_utils_get_shape(ncid, "edges%parent_glb_idx", 2)
      ALLOCATE(descrdata_obj%edges%parent_glb_idx(shap(1),shap(2)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%edges%parent_glb_idx))
    ENDIF
    status = nf90_inq_varid(ncid, "edges%parent_glb_blk", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:2) = nf90_utils_get_shape(ncid, "edges%parent_glb_blk", 2)
      ALLOCATE(descrdata_obj%edges%parent_glb_blk(shap(1),shap(2)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%edges%parent_glb_blk))
    ENDIF
    status = nf90_inq_varid(ncid, "edges%cell_idx", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "edges%cell_idx", 3)
      ALLOCATE(descrdata_obj%edges%cell_idx(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%edges%cell_idx))
    ENDIF
    status = nf90_inq_varid(ncid, "edges%cell_blk", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "edges%cell_blk", 3)
      ALLOCATE(descrdata_obj%edges%cell_blk(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%edges%cell_blk))
    ENDIF
    status = nf90_inq_varid(ncid, "edges%vertex_idx", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "edges%vertex_idx", 3)
      ALLOCATE(descrdata_obj%edges%vertex_idx(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%edges%vertex_idx))
    ENDIF
    status = nf90_inq_varid(ncid, "edges%vertex_blk", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:3) = nf90_utils_get_shape(ncid, "edges%vertex_blk", 3)
      ALLOCATE(descrdata_obj%edges%vertex_blk(shap(1),shap(2),shap(3)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%edges%vertex_blk))
    ENDIF
    status = nf90_inq_varid(ncid, "edges%elon", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:2) = nf90_utils_get_shape(ncid, "edges%elon", 2)
      ALLOCATE(descrdata_obj%edges%elon(shap(1),shap(2)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%edges%elon))
    ENDIF
    status = nf90_inq_varid(ncid, "edges%elat", var_id)
    IF (status == NF90_NOERR) THEN
      shap(1:2) = nf90_utils_get_shape(ncid, "edges%elat", 2)
      ALLOCATE(descrdata_obj%edges%elat(shap(1),shap(2)))
      CALL nf90(nf90_get_var(ncid, var_id, descrdata_obj%edges%elat))
    ENDIF

  END SUBROUTINE comin_descrdata_load_domain

END MODULE comin_descrdata_load
