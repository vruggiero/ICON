!  @authors 01/2024 :: ICON Community Interface  <comin@icon-model.org>
!
!  SPDX-License-Identifier: BSD-3-Clause
!
!  Please see the file LICENSE in the root of the source tree for this code.
!  Where software is supplied by third parties, it is indicated in the
!  headers of the routines.

! *** DO NOT EDIT MANUALLY!  Generated by python script in utils/. DO NOT EDIT MANUALLY! *** !

MODULE comin_descrdata_save

  USE netcdf,                 ONLY: nf90_put_att, nf90_put_var, NF90_GLOBAL, NF90_DOUBLE, &
    &                               NF90_INT, NF90_BYTE, NF90_CHAR
  USE netcdf_utils,           ONLY: nf90_utils_def_var, nf90
  USE comin_plugin_interface, ONLY: t_comin_descrdata_global, t_comin_descrdata_domain

  IMPLICIT NONE

  PUBLIC

CONTAINS

  SUBROUTINE comin_descrdata_save_global(ncid, descrdata_obj)
    INTEGER, INTENT(IN)                        :: ncid
    TYPE(t_comin_descrdata_global), INTENT(IN) :: descrdata_obj
    INTEGER :: var_id

    CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "n_dom", descrdata_obj%n_dom))
    CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "max_dom", descrdata_obj%max_dom))
    CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "nproma", descrdata_obj%nproma))
    CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "wp", descrdata_obj%wp))
    CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "min_rlcell_int", descrdata_obj%min_rlcell_int))
    CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "min_rlcell", descrdata_obj%min_rlcell))
    CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "max_rlcell", descrdata_obj%max_rlcell))
    CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "min_rlvert_int", descrdata_obj%min_rlvert_int))
    CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "min_rlvert", descrdata_obj%min_rlvert))
    CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "max_rlvert", descrdata_obj%max_rlvert))
    CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "min_rledge_int", descrdata_obj%min_rledge_int))
    CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "min_rledge", descrdata_obj%min_rledge))
    CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "max_rledge", descrdata_obj%max_rledge))
    CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "grf_bdywidth_c", descrdata_obj%grf_bdywidth_c))
    CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "grf_bdywidth_e", descrdata_obj%grf_bdywidth_e))
    CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "lrestartrun", MERGE(1,0,descrdata_obj%lrestartrun)))
    IF (ALLOCATED(descrdata_obj%vct_a)) THEN
      var_id = nf90_utils_def_var(ncid, "vct_a", NF90_DOUBLE, SHAPE(descrdata_obj%vct_a))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%vct_a))
    ENDIF
    CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "yac_instance_id", descrdata_obj%yac_instance_id))
    IF (ALLOCATED(descrdata_obj%host_git_remote_url)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "host_git_remote_url", TRIM(descrdata_obj%host_git_remote_url)))
    ENDIF
    IF (ALLOCATED(descrdata_obj%host_git_branch)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "host_git_branch", TRIM(descrdata_obj%host_git_branch)))
    ENDIF
    IF (ALLOCATED(descrdata_obj%host_git_tag)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "host_git_tag", TRIM(descrdata_obj%host_git_tag)))
    ENDIF
    IF (ALLOCATED(descrdata_obj%host_revision)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "host_revision", TRIM(descrdata_obj%host_revision)))
    ENDIF
    CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "has_device", MERGE(1,0,descrdata_obj%has_device)))
    IF (ALLOCATED(descrdata_obj%device_name)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "device_name", TRIM(descrdata_obj%device_name)))
    ENDIF
    IF (ALLOCATED(descrdata_obj%device_vendor)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "device_vendor", TRIM(descrdata_obj%device_vendor)))
    ENDIF
    IF (ALLOCATED(descrdata_obj%device_driver)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "device_driver", TRIM(descrdata_obj%device_driver)))
    ENDIF

  END SUBROUTINE comin_descrdata_save_global

  SUBROUTINE comin_descrdata_save_domain(ncid, descrdata_obj)
    INTEGER, INTENT(IN)                        :: ncid
    TYPE(t_comin_descrdata_domain), INTENT(IN) :: descrdata_obj
    INTEGER :: var_id

    IF (ASSOCIATED(descrdata_obj%grid_filename)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "grid_filename", TRIM(descrdata_obj%grid_filename)))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%grid_uuid)) THEN
      var_id = nf90_utils_def_var(ncid, "grid_uuid", NF90_INT, SHAPE(descrdata_obj%grid_uuid))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%grid_uuid))
    ENDIF
    IF (ALLOCATED(descrdata_obj%number_of_grid_used)) THEN
      var_id = nf90_utils_def_var(ncid, "number_of_grid_used", NF90_INT, SHAPE(descrdata_obj%number_of_grid_used))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%number_of_grid_used))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%id)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "id", descrdata_obj%id))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%n_childdom)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "n_childdom", descrdata_obj%n_childdom))
    ENDIF
    CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "dom_start", descrdata_obj%dom_start))
    CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "dom_end", descrdata_obj%dom_end))
    IF (ASSOCIATED(descrdata_obj%nlev)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "nlev", descrdata_obj%nlev))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%nshift)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "nshift", descrdata_obj%nshift))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%nshift_total)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "nshift_total", descrdata_obj%nshift_total))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%ncells)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "cells%ncells", descrdata_obj%cells%ncells))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%ncells_global)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "cells%ncells_global", descrdata_obj%cells%ncells_global))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%nblks)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "cells%nblks", descrdata_obj%cells%nblks))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%max_connectivity)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "cells%max_connectivity", descrdata_obj%cells%max_connectivity))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%num_edges)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%num_edges", NF90_INT, SHAPE(descrdata_obj%cells%num_edges))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%num_edges))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%refin_ctrl)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%refin_ctrl", NF90_INT, SHAPE(descrdata_obj%cells%refin_ctrl))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%refin_ctrl))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%start_index)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%start_index", NF90_INT, SHAPE(descrdata_obj%cells%start_index))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%start_index))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%end_index)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%end_index", NF90_INT, SHAPE(descrdata_obj%cells%end_index))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%end_index))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%start_block)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%start_block", NF90_INT, SHAPE(descrdata_obj%cells%start_block))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%start_block))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%end_block)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%end_block", NF90_INT, SHAPE(descrdata_obj%cells%end_block))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%end_block))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%child_id)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%child_id", NF90_INT, SHAPE(descrdata_obj%cells%child_id))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%child_id))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%child_idx)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%child_idx", NF90_INT, SHAPE(descrdata_obj%cells%child_idx))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%child_idx))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%child_blk)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%child_blk", NF90_INT, SHAPE(descrdata_obj%cells%child_blk))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%child_blk))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%parent_glb_idx)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%parent_glb_idx", NF90_INT, SHAPE(descrdata_obj%cells%parent_glb_idx))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%parent_glb_idx))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%parent_glb_blk)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%parent_glb_blk", NF90_INT, SHAPE(descrdata_obj%cells%parent_glb_blk))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%parent_glb_blk))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%vertex_idx)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%vertex_idx", NF90_INT, SHAPE(descrdata_obj%cells%vertex_idx))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%vertex_idx))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%vertex_blk)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%vertex_blk", NF90_INT, SHAPE(descrdata_obj%cells%vertex_blk))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%vertex_blk))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%neighbor_blk)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%neighbor_blk", NF90_INT, SHAPE(descrdata_obj%cells%neighbor_blk))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%neighbor_blk))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%neighbor_idx)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%neighbor_idx", NF90_INT, SHAPE(descrdata_obj%cells%neighbor_idx))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%neighbor_idx))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%edge_idx)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%edge_idx", NF90_INT, SHAPE(descrdata_obj%cells%edge_idx))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%edge_idx))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%edge_blk)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%edge_blk", NF90_INT, SHAPE(descrdata_obj%cells%edge_blk))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%edge_blk))
    ENDIF
    IF (ALLOCATED(descrdata_obj%cells%clon)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%clon", NF90_DOUBLE, SHAPE(descrdata_obj%cells%clon))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%clon))
    ENDIF
    IF (ALLOCATED(descrdata_obj%cells%clat)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%clat", NF90_DOUBLE, SHAPE(descrdata_obj%cells%clat))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%clat))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%area)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%area", NF90_DOUBLE, SHAPE(descrdata_obj%cells%area))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%area))
    ENDIF
    IF (ALLOCATED(descrdata_obj%cells%hhl)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%hhl", NF90_DOUBLE, SHAPE(descrdata_obj%cells%hhl))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%hhl))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%glb_index)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%glb_index", NF90_INT, SHAPE(descrdata_obj%cells%glb_index))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%glb_index))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%cells%decomp_domain)) THEN
      var_id = nf90_utils_def_var(ncid, "cells%decomp_domain", NF90_INT, SHAPE(descrdata_obj%cells%decomp_domain))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%cells%decomp_domain))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%verts%nverts)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "verts%nverts", descrdata_obj%verts%nverts))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%verts%nverts_global)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "verts%nverts_global", descrdata_obj%verts%nverts_global))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%verts%nblks)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "verts%nblks", descrdata_obj%verts%nblks))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%verts%num_edges)) THEN
      var_id = nf90_utils_def_var(ncid, "verts%num_edges", NF90_INT, SHAPE(descrdata_obj%verts%num_edges))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%verts%num_edges))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%verts%refin_ctrl)) THEN
      var_id = nf90_utils_def_var(ncid, "verts%refin_ctrl", NF90_INT, SHAPE(descrdata_obj%verts%refin_ctrl))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%verts%refin_ctrl))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%verts%start_index)) THEN
      var_id = nf90_utils_def_var(ncid, "verts%start_index", NF90_INT, SHAPE(descrdata_obj%verts%start_index))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%verts%start_index))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%verts%end_index)) THEN
      var_id = nf90_utils_def_var(ncid, "verts%end_index", NF90_INT, SHAPE(descrdata_obj%verts%end_index))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%verts%end_index))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%verts%start_block)) THEN
      var_id = nf90_utils_def_var(ncid, "verts%start_block", NF90_INT, SHAPE(descrdata_obj%verts%start_block))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%verts%start_block))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%verts%end_block)) THEN
      var_id = nf90_utils_def_var(ncid, "verts%end_block", NF90_INT, SHAPE(descrdata_obj%verts%end_block))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%verts%end_block))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%verts%neighbor_blk)) THEN
      var_id = nf90_utils_def_var(ncid, "verts%neighbor_blk", NF90_INT, SHAPE(descrdata_obj%verts%neighbor_blk))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%verts%neighbor_blk))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%verts%neighbor_idx)) THEN
      var_id = nf90_utils_def_var(ncid, "verts%neighbor_idx", NF90_INT, SHAPE(descrdata_obj%verts%neighbor_idx))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%verts%neighbor_idx))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%verts%cell_idx)) THEN
      var_id = nf90_utils_def_var(ncid, "verts%cell_idx", NF90_INT, SHAPE(descrdata_obj%verts%cell_idx))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%verts%cell_idx))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%verts%cell_blk)) THEN
      var_id = nf90_utils_def_var(ncid, "verts%cell_blk", NF90_INT, SHAPE(descrdata_obj%verts%cell_blk))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%verts%cell_blk))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%verts%edge_idx)) THEN
      var_id = nf90_utils_def_var(ncid, "verts%edge_idx", NF90_INT, SHAPE(descrdata_obj%verts%edge_idx))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%verts%edge_idx))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%verts%edge_blk)) THEN
      var_id = nf90_utils_def_var(ncid, "verts%edge_blk", NF90_INT, SHAPE(descrdata_obj%verts%edge_blk))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%verts%edge_blk))
    ENDIF
    IF (ALLOCATED(descrdata_obj%verts%vlon)) THEN
      var_id = nf90_utils_def_var(ncid, "verts%vlon", NF90_DOUBLE, SHAPE(descrdata_obj%verts%vlon))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%verts%vlon))
    ENDIF
    IF (ALLOCATED(descrdata_obj%verts%vlat)) THEN
      var_id = nf90_utils_def_var(ncid, "verts%vlat", NF90_DOUBLE, SHAPE(descrdata_obj%verts%vlat))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%verts%vlat))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%edges%nedges)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "edges%nedges", descrdata_obj%edges%nedges))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%edges%nedges_global)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "edges%nedges_global", descrdata_obj%edges%nedges_global))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%edges%nblks)) THEN
      CALL nf90(nf90_put_att(ncid, NF90_GLOBAL, "edges%nblks", descrdata_obj%edges%nblks))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%edges%refin_ctrl)) THEN
      var_id = nf90_utils_def_var(ncid, "edges%refin_ctrl", NF90_INT, SHAPE(descrdata_obj%edges%refin_ctrl))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%edges%refin_ctrl))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%edges%start_index)) THEN
      var_id = nf90_utils_def_var(ncid, "edges%start_index", NF90_INT, SHAPE(descrdata_obj%edges%start_index))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%edges%start_index))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%edges%end_index)) THEN
      var_id = nf90_utils_def_var(ncid, "edges%end_index", NF90_INT, SHAPE(descrdata_obj%edges%end_index))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%edges%end_index))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%edges%start_block)) THEN
      var_id = nf90_utils_def_var(ncid, "edges%start_block", NF90_INT, SHAPE(descrdata_obj%edges%start_block))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%edges%start_block))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%edges%end_block)) THEN
      var_id = nf90_utils_def_var(ncid, "edges%end_block", NF90_INT, SHAPE(descrdata_obj%edges%end_block))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%edges%end_block))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%edges%child_id)) THEN
      var_id = nf90_utils_def_var(ncid, "edges%child_id", NF90_INT, SHAPE(descrdata_obj%edges%child_id))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%edges%child_id))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%edges%child_idx)) THEN
      var_id = nf90_utils_def_var(ncid, "edges%child_idx", NF90_INT, SHAPE(descrdata_obj%edges%child_idx))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%edges%child_idx))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%edges%child_blk)) THEN
      var_id = nf90_utils_def_var(ncid, "edges%child_blk", NF90_INT, SHAPE(descrdata_obj%edges%child_blk))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%edges%child_blk))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%edges%parent_glb_idx)) THEN
      var_id = nf90_utils_def_var(ncid, "edges%parent_glb_idx", NF90_INT, SHAPE(descrdata_obj%edges%parent_glb_idx))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%edges%parent_glb_idx))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%edges%parent_glb_blk)) THEN
      var_id = nf90_utils_def_var(ncid, "edges%parent_glb_blk", NF90_INT, SHAPE(descrdata_obj%edges%parent_glb_blk))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%edges%parent_glb_blk))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%edges%cell_idx)) THEN
      var_id = nf90_utils_def_var(ncid, "edges%cell_idx", NF90_INT, SHAPE(descrdata_obj%edges%cell_idx))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%edges%cell_idx))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%edges%cell_blk)) THEN
      var_id = nf90_utils_def_var(ncid, "edges%cell_blk", NF90_INT, SHAPE(descrdata_obj%edges%cell_blk))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%edges%cell_blk))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%edges%vertex_idx)) THEN
      var_id = nf90_utils_def_var(ncid, "edges%vertex_idx", NF90_INT, SHAPE(descrdata_obj%edges%vertex_idx))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%edges%vertex_idx))
    ENDIF
    IF (ASSOCIATED(descrdata_obj%edges%vertex_blk)) THEN
      var_id = nf90_utils_def_var(ncid, "edges%vertex_blk", NF90_INT, SHAPE(descrdata_obj%edges%vertex_blk))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%edges%vertex_blk))
    ENDIF
    IF (ALLOCATED(descrdata_obj%edges%elon)) THEN
      var_id = nf90_utils_def_var(ncid, "edges%elon", NF90_DOUBLE, SHAPE(descrdata_obj%edges%elon))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%edges%elon))
    ENDIF
    IF (ALLOCATED(descrdata_obj%edges%elat)) THEN
      var_id = nf90_utils_def_var(ncid, "edges%elat", NF90_DOUBLE, SHAPE(descrdata_obj%edges%elat))
      CALL nf90(nf90_put_var(ncid, var_id, descrdata_obj%edges%elat))
    ENDIF

  END SUBROUTINE comin_descrdata_save_domain

END MODULE comin_descrdata_save
